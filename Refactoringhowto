Несколько улучшений в коде, которые вы можете внести:

    Разделение функций парсинга и получения данных из БД на разные модули, чтобы улучшить читаемость кода.

    Использование оператора with при работе с БД, чтобы автоматически закрыть сессию по окончании работы.

    Оптимизация использования заголовков HTTP, удалив лишние или задав стандартные.

    Использование декоратора lru_cache для функции get_prices, чтобы кешировать результаты и не выполнять запросы к сайту каждый раз.

    Использование async/await для асинхронной работы с веб-сайтами, чтобы ускорить парсинг.

    Рефакторинг кода, чтобы улучшить его читаемость и понимание, например, использование понятных имен переменных и функций